# 短信网关-验证码查看

## 使用说明

1. 浏览器访问[http://200.200.136.45:88](http://200.200.136.45:88)
2. 点击“帮助”，按照说明在VPN设备上配置短信认证
3. 配置好之后，可以在[http://200.200.136.45:88](http://200.200.136.45:88)过滤需要的短信验证码

## json
如果要返回json格式的数据，请在浏览器内访问 http://200.200.136.45:88/msgs.json?utf8=%E2%9C%93&f_vpnip=200.200.136.47&f_phone=18499990000&f_user=test&commit=%E8%BF%87%E6%BB%A4
其中，f_vpnip,f_phone,f_user分别表示要过滤的vpn ip地址, 手机号码, 用户名(or短信内容)

请求结果为:

```
[
    {
        "id": 1425017205, 
        "vpnip": "200.200.136.47", 
        "vpnmac": "00:50:56:8d:7b:c6", 
        "phone": "8618499990000", 
        "sms": "您好,testuser,登录IP,192.168.1.2,本次登录验证码为:444747,呵呵,验证码有效期至:2015-2-27 12:54", 
        "url": "http://200.200.136.45:88/msgs/1425017205.json"
    }
    {
        "id": 1425017206, 
        "vpnip": "200.200.136.47", 
        "vpnmac": "00:50:56:8d:7b:c6", 
        "phone": "8618499990000", 
        "sms": "您好,testuser,登录IP,192.168.1.2,本次登录验证码为:444748,呵呵,验证码有效期至:2015-2-27 12:54", 
        "url": "http://200.200.136.45:88/msgs/1425017205.json"
    }
]
```

服务器会返回满足过滤条件的前100条短信信息。


## 环境搭建

1. 安装winpcap
2. 运行`/Simulator_Cracked.exe`，并设置（设定 -> 中国联通SGIP设置 -> 增加 -> SP接入号码:1234 ->密码:1234 -> 监听IP:200.200.136.45 -> 接入端口:8802）
3. 运行`ruby /sim/db/sim.rb`
4. 运行`rails s -p 88 -b 0.0.0.0`